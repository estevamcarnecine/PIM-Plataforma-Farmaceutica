# üìÑ Dossi√™ de Requisitos e Arquitetura - Plataforma Farmac√™utica

Este documento estabelece os requisitos t√©cnicos e as diretrizes estrat√©gicas de arquitetura para o desenvolvimento da Plataforma Farmac√™utica, garantindo a conformidade regulat√≥ria com **FDA 21 CFR Part 11** e **GAMP 5**.

---

## I. Requisitos de Arquitetura de Redes e Sistemas Distribu√≠dos

O foco √© o desenho e implementa√ß√£o de um ecossistema digital baseado em arquitetura distribu√≠da de baixa lat√™ncia.

* **Infraestrutura L√≥gica:** Elaborar um prot√≥tipo de infraestrutura l√≥gica que conecte os m√≥dulos da plataforma em uma topologia hier√°rquica resiliente.
* **Segmenta√ß√£o e Controle:** Consolidar a infraestrutura de rede segmentando-a por **VLANs**.
* **Redes Definidas por Software (SDN):** O controle da rede deve ser feito por SDN, com a implementa√ß√£o simulada a partir de controladores como **OpenDaylight**.
* **Roteamento:** Contemplar pol√≠ticas de roteamento redundante simuladas com protocolos como **OSPF** ou **BGP**.
* **Seguran√ßa e QoS:** O design deve fornecer isolamento de fluxos sens√≠veis e permitir a aplica√ß√£o de pol√≠ticas de **QoS** espec√≠ficas para registros audit√°veis e dados cl√≠nicos confidenciais.
* **Resili√™ncia e Continuidade:** O sistema deve ter toler√¢ncia a falhas e desempenho previs√≠vel, suportando replica√ß√£o tolerante a falhas e consist√™ncia eventual.
* **Conformidade Regulat√≥ria:** As pr√°ticas de seguran√ßa devem atender aos crit√©rios de seguran√ßa previstos no **FDA 21 CFR Part 11**.
* **Avalia√ß√£o:** O desempenho da infraestrutura deve ser demonstrado por meio de m√©tricas de **lat√™ncia**, **throughput** e **disponibilidade**.

---

## II. Requisitos de Programa√ß√£o Estruturada em C

A Programa√ß√£o Estruturada em C √© requerida para garantir desempenho determin√≠stico e lat√™ncia m√≠nima na aquisi√ß√£o de sinais laboratoriais e fabris.

### Funcionalidades Obrigat√≥rias:

Desenvolver um conjunto de bibliotecas nativas em C, compiladas para execu√ß√£o em dispositivos de borda, que devem realizar:

* Rotinas de **filtragem digital** (filtragem de sinais).
* **Compress√£o sem perda** (ou adaptativa) de registros biom√©dicos.
* **Escrita segura** em sistemas de arquivos journaling.
* **Grava√ß√£o segura** em arquivos bin√°rios.

### Especifica√ß√µes T√©cnicas:

* **Uso da Linguagem:** Explorar o uso criterioso de vetores, matrizes, fun√ß√µes, ponteiros, controle de fluxo e manipula√ß√£o de arquivos.
* **Formatos de Dados:** Os resultados devem ser gravados em formatos **bin√°rios padronizados** que preservem a precis√£o de ponto flutuante.
* **Integra√ß√£o:** Os m√≥dulos nativos em C devem demonstrar integra√ß√£o por **FFI (Foreign Function Interface)** com camadas superiores em Python ou C++.
* **Avalia√ß√£o de Desempenho:** O desempenho ser√° avaliado por benchmarks de uso de **CPU**, **lat√™ncia m√©dia** e **consumo de mem√≥ria**, seguindo metodologia reprodut√≠vel.

---

## III. Requisitos de Intelig√™ncia Artificial

A plataforma deve ser apoiada por modelos de intelig√™ncia artificial explic√°veis.

### 1. Entrega de Modelos Funcionais

A equipe deve construir pipelines completos e entregar **tr√™s modelos funcionais**:

| Modelo | Algoritmo | Prop√≥sito |
| :--- | :--- | :--- |
| **Classificador** | Aprendizado Supervisionado | Estratifica√ß√£o de volunt√°rios |
| **Rede Convolucional** | Redes Neurais Profundas (CNN) | Inspe√ß√£o visual de comprimidos |
| **Preditor** | Aprendizado Supervisionado/RNN | Predi√ß√£o de rendimento de lotes |

### 2. Explicabilidade (XAI)

A inteligibilidade dos modelos deve ser garantida por m√©todos de explicabilidade, gerando artefatos que possam ser revisados por avaliadores regulat√≥rios:

* **Dados Tabulares (Classificador/Preditor):** Utiliza√ß√£o de **SHAP** (SHapley Additive exPlanations).
* **Vis√£o (CNN):** Utiliza√ß√£o de **Grad-CAM** (Gradient-weighted Class Activation Mapping).

### 3. Documenta√ß√£o T√©cnica de IA

Os documentos t√©cnicos devem incluir:

* **Matriz de confus√£o**, **Curvas ROC**.
* M√©tricas de **precis√£o** e **F1-score**.
* Relat√≥rios de explicabilidade.

---

## IV. Requisitos de An√°lise e Projeto de Sistemas (Modelagem e Auditabilidade)

Esta se√ß√£o lida com a modelagem do software e a documenta√ß√£o t√©cnica rigorosa, compat√≠vel com o dom√≠nio regulamentado.

* **Modelagem e Ferramentas:** Utilizar ferramentas **CASE** (Computer-Aided Software Engineering) para a produ√ß√£o de diagramas.
* **Rastreabilidade:** Deve haver rastreabilidade completa entre requisitos, componentes e testes.
* **Dossi√™ de Auditoria:** Compilar um dossi√™ capaz de ser auditado conforme **GAMP 5** e **FDA 21 CFR Part 11**.

### Diagramas Obrigat√≥rios:

| Diagrama | Prop√≥sito no Projeto |
| :--- | :--- |
| **Casos de Uso** | Representar as intera√ß√µes entre Atores e o sistema. |
| **Classes** | Definir a estrutura est√°tica dos dados (ex: `RegistroBiomedico`, `LogAuditoria`). |
| **Sequ√™ncia** | Modelar o fluxo de baixa lat√™ncia (ex: Dispositivo C -> Camada FFI). |
| **Implanta√ß√£o** | Ilustrar a topologia de hardware e software. |

---

# üìë Dossi√™ de Arquitetura e Estrat√©gia do Projeto

## I. Estrat√©gia de Arquitetura de Redes e Sistemas Distribu√≠dos

### 1. Topologia e Resili√™ncia

* **Topologia Escolhida:**
    * **Data Center:** Arquitetura **Spine-Leaf** (baixa lat√™ncia e alta largura de banda).
    * **Borda (Laborat√≥rio/F√°brica):** Modelo **Hier√°rquico de Tr√™s Camadas** (isolamento de falhas).
* **Resili√™ncia:** Implementa√ß√£o de **VRRP/HSRP** no core e roteamento **ECMP** (Equal-Cost Multi-Path) na malha Spine-Leaf para redund√¢ncia ativa-ativa.

### 2. Segmenta√ß√£o (VLANs) e Controle

A rede ser√° segmentada com o uso de um controlador SDN (simulado por OpenDaylight) para gerenciar o fluxo e pol√≠ticas de QoS.

| VLAN | Prop√≥sito | Prioridade QoS |
| :--- | :--- | :--- |
| **VLAN Audit** | Fluxo de dados de auditoria (logs, acessos). | Alta (Strict Priority) |
| **VLAN Clinical/Lab** | Dados confidenciais e aquisi√ß√£o de sinais (m√≥dulos C). | Alta (Strict Priority) |
| **VLAN AI/Compute** | Servidores de processamento de modelos de IA. | M√©dia |
| **VLAN Management** | Acesso de administradores e controladores SDN. | Baixa |

### 3. Seguran√ßa e Conformidade (FDA 21 CFR Part 11)

* **Isolamento:** Uso de **ACLs** aplicadas pela SDN para impedir comunica√ß√£o direta entre VLANs sens√≠veis, for√ßando o tr√°fego a passar por um Firewall Virtual.
* **Conformidade:**
    * **Assinaturas Eletr√¥nicas:** O m√≥dulo C deve gerar um **hash (checksum)** para o registro bin√°rio.
    * **Trilhas de Auditoria (Audit Trails):** Eventos cr√≠ticos devem ser registrados de forma **imut√°vel** na VLAN Audit.
    * **Comunica√ß√£o:** Uso obrigat√≥rio de **TLS/VPN** entre m√≥dulos.

---

## II. Estrat√©gia de Intelig√™ncia Artificial

### 1. Pipelines e Algoritmos

Detalhe dos modelos a serem implementados:

| Modelo | Algoritmo/Arquitetura | Dados de Entrada | Estrat√©gia de Sa√≠da |
| :--- | :--- | :--- | :--- |
| **Classificador** | Random Forest / XGBoost | Caracter√≠sticas demogr√°ficas/biom√©tricas | Categoria de risco/estratifica√ß√£o. |
| **Rede Convolucional** | VGG / ResNet | Imagens de alta resolu√ß√£o de comprimidos | Classifica√ß√£o de defeito (Good/Defective). |
| **Preditor** | RNN / MLP | Par√¢metros de processo (s√©rie temporal) | Previs√£o de rendimento percentual do lote. |

### 2. Explicabilidade (XAI) na Pr√°tica

| Modelo | M√©todo XAI | Artefato para Reguladores |
| :--- | :--- | :--- |
| **Classificador/Preditor** | **SHAP** | Quantifica√ß√£o da contribui√ß√£o de cada *feature*. |
| **Rede Convolucional** | **Grad-CAM** | Mapas de calor que destacam regi√µes da imagem que influenciaram a decis√£o. |

---

## III. Estrat√©gia de An√°lise e Projeto de Sistemas

### 1. Padr√µes de Projeto (Design Patterns)

| Padr√£o Escolhido | Justificativa T√©cnica |
| :--- | :--- |
| **Microservices** | Favorece a escalabilidade, a resili√™ncia e a separa√ß√£o de dom√≠nios (Aquisi√ß√£o, IA, Auditoria). |
| **Observer/Publisher-Subscriber** | Ideal para a arquitetura distribu√≠da, notificando m√≥dulos de IA em tempo real sobre novos dados. |
| **Repository** | Abstrair a l√≥gica de acesso a dados (banco de dados/arquivos bin√°rios) das regras de neg√≥cio. |

### 2. Dossi√™ de Auditoria (Conformidade GAMP 5)

O dossi√™ de auditoria ser√° estruturado seguindo as 5 fases do ciclo de vida **GAMP 5**:

1.  **Conceito:** Justificativa e Classifica√ß√£o do Sistema (**GAMP 5 Categoria 4: Software Configur√°vel**).
2.  **Fase de Projeto:** Especifica√ß√£o de Requisitos do Usu√°rio (**URS**), Especifica√ß√£o Funcional (**FS**), Especifica√ß√£o de Configura√ß√£o (**CS**).
3.  **Fase de Teste e Verifica√ß√£o:** Protocolos de Teste (**FAT, SAT, IQ, OQ, PQ**).
4.  **Fase de Opera√ß√£o:** Procedimentos Operacionais Padr√£o (**SOPs**), Treinamento, Gest√£o de Mudan√ßas.
5.  **Fase de Aposentadoria:** Plano de migra√ß√£o e arquivo de dados.